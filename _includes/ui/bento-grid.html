{% comment %}
  Bento Grid Component - Modern grid layout with 3D effects
  Usage: {% include ui/bento-grid.html items=bento_items %}
  
  Parameters:
  - items: Array of grid items (required)
    Each item should have:
    - title: Item title
    - content: Item content (HTML allowed)
    - icon: Icon SVG or HTML (optional)
    - size: sm, md, lg, xl (default: md) - controls grid span
    - variant: default, glass, glow, aurora (default: default)
    - href: Link URL (optional, makes the entire card clickable)
  - gap: Grid gap size (default: gap-6)
  - class: Additional CSS classes for the container
  - animate: true/false - Enable entrance animations (default: true)
{% endcomment %}

{% assign gap = include.gap | default: 'gap-6' %}
{% assign animate = include.animate | default: true %}

<div class="bento-grid {{ gap }} {{ include.class }}">
  {% for item in include.items %}
    {% assign size = item.size | default: 'md' %}
    {% assign variant = item.variant | default: 'default' %}
    
    {% capture sizeClasses %}
      {% case size %}
        {% when 'sm' %}
          col-span-1 row-span-1
        {% when 'md' %}
          col-span-1 md:col-span-2 row-span-1
        {% when 'lg' %}
          col-span-1 md:col-span-2 lg:col-span-3 row-span-1 md:row-span-2
        {% when 'xl' %}
          col-span-1 md:col-span-2 lg:col-span-4 row-span-1 md:row-span-2
      {% endcase %}
    {% endcapture %}
    
    {% capture variantClasses %}
      {% case variant %}
        {% when 'default' %}
          bento-item
        {% when 'glass' %}
          bento-item glass-modern
        {% when 'glow' %}
          bento-item glow-card
        {% when 'aurora' %}
          bento-item aurora-bg-animated
      {% endcase %}
    {% endcapture %}
    
    {% capture itemClasses %}
      {{ sizeClasses | strip }} {{ variantClasses | strip }}
      {% if animate %}scroll-trigger{% endif %}
      {% if item.href %}hover:scale-[1.02] cursor-pointer{% endif %}
    {% endcapture %}
    
    {% if item.href %}
      <a href="{{ item.href }}" 
         class="{{ itemClasses | strip }}"
         style="--index: {{ forloop.index0 }};">
    {% else %}
      <div class="{{ itemClasses | strip }}"
           style="--index: {{ forloop.index0 }};">
    {% endif %}
      
      <div class="p-6 md:p-8 h-full flex flex-col">
        {% if item.icon %}
          <div class="mb-4">
            <div class="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-primary-500/20 to-secondary-500/20 text-primary-600">
              {{ item.icon }}
            </div>
          </div>
        {% endif %}
        
        {% if item.title %}
          <h3 class="text-xl md:text-2xl font-semibold mb-3 
                     {% if variant == 'aurora' %}text-white{% else %}text-gray-900{% endif %}">
            {{ item.title }}
          </h3>
        {% endif %}
        
        <div class="flex-1 {% if variant == 'aurora' %}text-white/90{% else %}text-gray-600{% endif %}">
          {{ item.content }}
        </div>
        
        {% if item.href %}
          <div class="mt-4 inline-flex items-center text-primary-600 hover:text-primary-700 font-medium">
            <span>了解更多</span>
            <svg class="w-4 h-4 ml-2 transition-transform group-hover:translate-x-1" 
                 viewBox="0 0 20 20" 
                 fill="currentColor">
              <path fill-rule="evenodd" 
                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" 
                    clip-rule="evenodd"/>
            </svg>
          </div>
        {% endif %}
      </div>
      
      <!-- 3D hover effect overlay -->
      <div class="absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none">
        <div class="absolute inset-0 bg-gradient-to-br from-transparent via-white/5 to-transparent"></div>
      </div>
      
    {% if item.href %}
      </a>
    {% else %}
      </div>
    {% endif %}
  {% endfor %}
</div>

<!-- Initialize Bento Grid interactions -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const bentoItems = document.querySelectorAll('.bento-item');
  
  bentoItems.forEach(item => {
    item.addEventListener('mousemove', (e) => {
      const rect = item.getBoundingClientRect();
      const x = ((e.clientX - rect.left) / rect.width) * 100;
      const y = ((e.clientY - rect.top) / rect.height) * 100;
      
      item.style.setProperty('--mouse-x', `${x}%`);
      item.style.setProperty('--mouse-y', `${y}%`);
    });
    
    item.addEventListener('mouseleave', () => {
      item.style.setProperty('--mouse-x', '50%');
      item.style.setProperty('--mouse-y', '50%');
    });
  });
});
</script>